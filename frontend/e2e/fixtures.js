/* eslint-disable react-hooks/rules-of-hooks */
import { test as base, expect } from '@playwright/test';
import { ethers } from 'ethers';

export const TestToken = {
  abi: [
    'constructor()',
    'function mint(address to, uint256 amount)',
    'function approve(address spender, uint256 amount) returns (bool)',
    'function balanceOf(address) view returns (uint256)',
    'function transfer(address to, uint256 amount) returns (bool)'
  ],
  bytecode: '0x608060405234801561001057600080fd5b5033600090815260208190526040902069021e19e0c9bab240000090556105f1806100396000396000f3fe608060405234801561001057600080fd5b50600436106100575760003560e01c806340c10f191461005c57806370a082311461007157806395d89b411461009a578063a9059cbb146100a2578063dd62ed3e146100b5575b600080fd5b61006f61006a3660046103ba565b6100c8565b005b61008461007f3660046103e4565b6100db565b6040516100919190610406565b60405180910390f35b610084600181565b61006f6100b036600461040f565b6100f3565b6100846100c336600461043b565b610107565b6100d28282610114565b5050565b60006020819052908152604090205481565b6100fd8282610193565b5050565b9092915050565b600092915050565b8061011f33846101e9565b61015e5760405162461bcd60e51b815260206004820152600b60248201526a1a5b9cdd59999a58da595960aa1b604482015260640160405180910390fd5b336000908152602081905260409020548211156101785750565b3360009081526020819052604090208054839003905550565b5050565b806101a13384610250565b6101e05760405162461bcd60e51b815260206004820152601060248201526f1d1c985b9cd9995c8819985a5b195960821b604482015260640160405180910390fd5b50505050565b60006101f583836102b0565b61024857506001600160a01b03821660009081526020819052604090205482111561023957600082815260208190526040902054610233906104755b91505061024a565b5060015b61024a565b5060005b92915050565b600082610296576001600160a01b0382166000908152602081905260409020548211156102905760008281526020819052604090205461028a90610498565b91505061024a565b5061024a565b6001600160a01b0382166000908152602081905260409020548281101561029057600191505061024a565b60008215610301576001600160a01b038316600090815260208190526040902054838110156102f657600084815260208190526040902054915050610347565b5060001915610347565b6001600160a01b0383166000908152602081905260409020548311156103405760008481526020819052604090205491505061034756600019610347565b5092915050565b600080fd5b6001600160a01b038116811461036857600080fd5b50565b6000806040838503121561037e57600080fd5b82359150602083013561039081610353565b809150509250929050565b6000602082840312156103ae57600080fd5b81356103b981610353565b9392505050565b600080604083850312156103d357600080fd5b823561039081610353565b6000602082840312156103f057600080fd5b5035919050565b90815260200190565b600080604083850312156104145760046000fd5b50508035926020909101359150565b60006020828403121561043657600080fd5b81356103b981610353565b6000806040838503121561045457600080fd5b823561045f81610353565b9150602083013561039081610353565b634e487b7160e01b600052601160045260246000fd5b8082018082111561024a5761024a61047056fea26469706673582212209d4e8f3c7a2b1d6e5f8a9b0c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e64736f6c63430008170033'
};

export const test = base.extend({
  // eslint-disable-next-line no-empty-pattern
  provider: async ({}, use) => {
    const provider = new ethers.JsonRpcProvider('http://localhost:8545');
    await use(provider);
  },

  wallets: async ({ provider }, use) => {
    const accounts = [
      '0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80', // Priest
      '0x59c6995e998f97a5a0044966f0945389dc9e86dae88c7a8412f4603b6b78690d', // Member
      '0x5de4111afa1a4b94908f83103eb1f1706367c2e68ca870fc3fb9a804cdab365a', // Delegate
    ];

    const wallets = {
      priest: new ethers.Wallet(accounts[0], provider),
      member: new ethers.Wallet(accounts[1], provider),
      delegate: new ethers.Wallet(accounts[2], provider)
    };

    await use(wallets);
  }
});

export { expect };
